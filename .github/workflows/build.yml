name: Build
on: [push, pull_request]
env:
  PARLAY_NUM_THREADS: 16

jobs:
  
  coverage:
    name: MSVC
    runs-on: windows-latest
    steps:
    - uses: actions/checkout@v2
    - uses: ilammy/msvc-dev-cmd@v1
    - name: Configure
      run: |
        md build
        cd build
        cmake -G $env:generator -A x64 -DCMAKE_BUILD_TYPE=Debug -DCMAKE_CXX_FLAGS_DEBUG=" /bigobj " -DPARLAY_TEST=On ..
        
    - name: Build
      run: |
        cd build
        cmake --build .
        
    - name: Test
      run: |
        cd build
        ctest -C Debug --no-tests=error --output-on-failure
